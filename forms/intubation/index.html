<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Intubation Checklist + Clinical Note Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 p-6">

  <div class="max-w-4xl mx-auto bg-white shadow p-6 rounded">
    <h1 class="text-3xl font-bold mb-6">Intubation Checklist + Clinical Note Generator</h1>

    <!-- Free text fields -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <div>
        <label class="font-medium">Procedure Date:</label>
        <input type="date" id="proc_date" class="w-full border p-2 rounded">
      </div>
      <div>
        <label class="font-medium">Time:</label>
        <input type="text" id="proc_time" class="w-full border p-2 rounded">
      </div>
      <div>
        <label class="font-medium">Operator:</label>
        <input type="text" id="operator" class="w-full border p-2 rounded">
      </div>
      <div>
        <label class="font-medium">Assistant:</label>
        <input type="text" id="assistant" class="w-full border p-2 rounded">
      </div>
      <div>
        <label class="font-medium">Supervisor:</label>
        <input type="text" id="supervisor" class="w-full border p-2 rounded">
      </div>
    </div>

    <!-- BEFORE THE PROCEDURE -->
    <h2 class="text-xl font-bold bg-red-600 text-white p-2 mt-4">BEFORE THE PROCEDURE</h2>
    <div class="grid grid-cols-1 gap-4 mt-4">

      <div class="font-bold text-lg mt-2">Planning</div>

      <div>
        <div class="font-medium">Patient identity checked?</div>
        <label><input type="checkbox" name="identity" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div>
        <div class="font-medium">Patient position optimised?</div>
        <label><input type="checkbox" name="positionOptimised" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div>
        <div class="font-medium">Are spinal precautions required?</div>
        <label><input type="checkbox" name="spinalPrecautions" value="Yes" onchange="onlyOne(this)"> Yes</label>
        <label><input type="checkbox" name="spinalPrecautions" value="No" onchange="onlyOne(this)"> No</label>
      </div>

      <div>
        <div class="font-medium">Pre-oxygenation plan?</div>
        <label><input type="checkbox" name="preoxygenation" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div>
        <div class="font-medium">Cricoid pressure?</div>
        <label><input type="checkbox" name="cricoid" value="Yes" onchange="onlyOne(this)"> Yes</label>
        <label><input type="checkbox" name="cricoid" value="No" onchange="onlyOne(this)"> No</label>
      </div>

      <div>
        <div class="font-medium">Is an NG tube required?</div>
        <label><input type="checkbox" name="ngRequired" value="Yes" onchange="onlyOne(this)"> Yes</label>
        <label><input type="checkbox" name="ngRequired" value="No" onchange="onlyOne(this)"> No</label>
      </div>

      <div>
        <div class="font-medium">NG tube aspirated?</div>
        <label><input type="checkbox" name="ngAspirated" value="Yes" onchange="onlyOne(this)"> Yes</label>
        <label><input type="checkbox" name="ngAspirated" value="N/A" onchange="onlyOne(this)"> N/A</label>
      </div>

      <div>
        <div class="font-medium">Known drug allergies?</div>
        <label><input type="checkbox" name="drugAllergies" value="Yes" onchange="onlyOne(this)"> Yes</label>
        <label><input type="checkbox" name="drugAllergies" value="No" onchange="onlyOne(this)"> No</label>
      </div>

      <div>
        <div class="font-medium">Adequate venous access available?</div>
        <label><input type="checkbox" name="venousAccess" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div class="font-bold text-lg mt-4">Equipment & Drugs</div>

      <div><div class="font-medium">Monitoring attached? (ECG, SpO₂, BP, EtCO₂)</div>
        <label><input type="checkbox" name="monitoring" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div><div class="font-medium">Manual ventilation device available?</div>
        <label><input type="checkbox" name="ventDevice" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div><div class="font-medium">Suction available?</div>
        <label><input type="checkbox" name="suction" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div><div class="font-medium">Laryngoscopes available?</div>
        <label><input type="checkbox" name="laryngoscopes" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div><div class="font-medium">Endotracheal tube(s) available?</div>
        <label><input type="checkbox" name="ett" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div><div class="font-medium">Bougie available?</div>
        <label><input type="checkbox" name="bougie" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div><div class="font-medium">Oropharyngeal airways available?</div>
        <label><input type="checkbox" name="opa" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div><div class="font-medium">Supraglottic airway available?</div>
        <label><input type="checkbox" name="sga" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div><div class="font-medium">Difficult Airway Trolley location noted?</div>
        <label><input type="checkbox" name="dat" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div><div class="font-medium">Drugs ready (induction, muscle relaxant, emergency)?</div>
        <label><input type="checkbox" name="drugsReady" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div class="font-bold text-lg mt-4">Team</div>

      <div>
        <div class="font-medium">Location of senior help known?</div>
        <label><input type="checkbox" name="seniorHelp" value="Yes" onchange="onlyOne(this)"> Yes</label>
        <label><input type="checkbox" name="seniorHelp" value="N/A" onchange="onlyOne(this)"> N/A</label>
      </div>

      <div>
        <div class="font-medium">Tasks allocated?</div>
        <label><input type="checkbox" name="tasksAllocated" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>
    </div>

    <!-- TIME OUT -->
    <h2 class="text-xl font-bold bg-yellow-400 text-black p-2 mt-8">TIME OUT</h2>
    <div class="grid grid-cols-1 gap-4 mt-4">

      <div>
        <div class="font-medium">Verbal confirmation between team members before start of procedure</div>
        <label><input type="checkbox" name="teamConfirm" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div>
        <div class="font-medium">Difficult airway anticipated?</div>
        <label><input type="checkbox" name="difficultAirway" value="Yes" onchange="onlyOne(this)"> Yes</label>
        <label><input type="checkbox" name="difficultAirway" value="No" onchange="onlyOne(this)"> No</label>
      </div>

      <div>
        <div class="font-medium">If yes, plans discussed</div>
        <label><input type="checkbox" name="airwayPlans" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div>
        <div class="font-medium">Any other concerns about the procedure (e.g. cardiovascular instability)?</div>
        <label><input type="checkbox" name="otherConcerns" value="Yes" onchange="onlyOne(this)"> Yes</label>
        <label><input type="checkbox" name="otherConcerns" value="No" onchange="onlyOne(this)"> No</label>
      </div>

      <div>
        <div class="font-medium">If yes, plans discussed</div>
        <label><input type="checkbox" name="concernPlans" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

    </div>

    <!-- SIGN OUT -->
    <h2 class="text-xl font-bold bg-green-600 text-white p-2 mt-8">SIGN OUT</h2>
    <div class="grid grid-cols-1 gap-4 mt-4">

      <div>
        <div class="font-medium">Endotracheal position confirmed with CO₂ trace</div>
        <label><input type="checkbox" name="co2Confirm" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div>
        <div class="font-medium">Tube depth checked (bilateral air entry)</div>
        <label><input type="checkbox" name="airEntry" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div>
        <div class="font-medium">ETT secured?</div>
        <label><input type="checkbox" name="ettSecured" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div>
        <div class="font-medium">Cuff pressure checked?</div>
        <label><input type="checkbox" name="cuffPressure" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div>
        <div class="font-medium">Ventilator settings appropriate?</div>
        <label><input type="checkbox" name="ventSettings" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div>
        <div class="font-medium">Analgesia and sedation started?</div>
        <label><input type="checkbox" name="analgSed" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

      <div>
        <div class="font-medium">Chest X-Ray required?</div>
        <label><input type="checkbox" name="cxrRequired" value="Yes" onchange="onlyOne(this)"> Yes</label>
        <label><input type="checkbox" name="cxrRequired" value="No" onchange="onlyOne(this)"> No</label>
      </div>

      <div>
        <div class="font-medium">Procedure documented in patient records?</div>
        <label><input type="checkbox" name="documentation" value="Yes" onchange="onlyOne(this)"> Yes</label>
      </div>

    </div>

    <!-- PROCEDURE DETAILS (FULL NEW SECTION) -->
    <div class="bg-purple-600 text-white font-bold text-lg px-4 py-2 rounded mt-6">
      PROCEDURE DETAILS
    </div>

    <div class="mt-4 space-y-6">

      <div>
        <div class="font-medium">Indication for intubation:</div>
        <input type="text" id="indication_intub" class="border p-2 rounded w-full">
      </div>

      <!-- PERSONNEL -->
      <div class="border p-4 bg-gray-50 rounded">
        <div class="font-bold mb-3">Personnel</div>

        <div class="mb-2 font-medium">Airway operator:</div>
        <div class="grid grid-cols-2 gap-2">
          <input type="text" id="airway_name" placeholder="Name" class="border p-2 rounded w-full">
          <input type="text" id="airway_grade" placeholder="Grade" class="border p-2 rounded w-full">
        </div>

        <div class="mt-4 mb-2 font-medium">Drugs (given by):</div>
        <div class="grid grid-cols-2 gap-2">
          <input type="text" id="drugs_name" placeholder="Name" class="border p-2 rounded w-full">
          <input type="text" id="drugs_grade" placeholder="Grade" class="border p-2 rounded w-full">
        </div>

        <div class="mt-4 mb-2 font-medium">Other assistant:</div>
        <div class="grid grid-cols-2 gap-2">
          <input type="text" id="assistant_name" placeholder="Name" class="border p-2 rounded w-full">
          <input type="text" id="assistant_grade" placeholder="Grade" class="border p-2 rounded w-full">
        </div>
      </div>

      <!-- INTUBATION -->
      <div class="font-bold text-lg">Intubation</div>

      <div>
        <div class="font-medium">Pre-oxygenation technique:</div>
        <div class="flex flex-col gap-1">
          <label><input type="checkbox" name="preox" value="Water's circuit"> Water's circuit</label>
          <label><input type="checkbox" name="preox" value="NIV/CPAP"> NIV/CPAP</label>
          <label><input type="checkbox" name="preox" value="Nasal cannula"> Nasal cannula</label>
          <div class="flex items-center gap-2">
            <label><input type="checkbox" name="preox" value="Other"> Other:</label>
            <input type="text" id="preox_other" placeholder="Specify" class="border p-2 rounded w-full">
          </div>
        </div>
      </div>

      <div>
        <div class="font-medium">Laryngoscopy grade:</div>
        <input type="text" id="laryngoscopy_grade" class="border p-2 rounded w-full">
      </div>

      <div>
        <div class="font-medium">Laryngoscope used:</div>
        <div class="flex flex-col gap-1">
          <label><input type="checkbox" name="laryngoscope" value="Mac 3"> Mac 3</label>
          <label><input type="checkbox" name="laryngoscope" value="Mac 4"> Mac 4</label>
          <label><input type="checkbox" name="laryngoscope" value="Video-laryngoscope"> Video-laryngoscope</label>
          <div class="flex items-center gap-2">
            <label><input type="checkbox" name="laryngoscope" value="Other"> Other:</label>
            <input type="text" id="laryngoscope_other" placeholder="Specify" class="border p-2 rounded w-full">
          </div>
        </div>
      </div>

      <div>
        <div class="font-medium">Adjuncts used:</div>
        <input type="text" id="adjuncts_used" class="border p-2 rounded w-full">
      </div>

      <div>
        <div class="font-medium">ETT size (ID mm):</div>
        <input type="text" id="ett_size" class="border p-2 rounded w-full">
      </div>

      <div>
        <div class="font-medium">Length at teeth (cm):</div>
        <input type="text" id="ett_length" class="border p-2 rounded w-full">
      </div>

      <div>
        <div class="font-medium">Route:</div>
        <label><input type="checkbox" name="route" value="Oral" onchange="onlyOne(this)"> Oral</label>
        <label><input type="checkbox" name="route" value="Nasal" onchange="onlyOne(this)"> Nasal</label>
      </div>

      <!-- DRUGS -->
      <div class="border p-4 bg-gray-50 rounded">
        <div class="font-bold mb-2">Drugs</div>

        <div class="mb-2">
          <div class="font-medium">Opiate (drug & dose):</div>
          <input type="text" id="drug_opiate" class="border p-2 rounded w-full">
        </div>

        <div class="mb-2">
          <div class="font-medium">Induction (drug & dose):</div>
          <input type="text" id="drug_induction" class="border p-2 rounded w-full">
        </div>

        <div class="mb-2">
          <div class="font-medium">Muscle relaxant (drug & dose):</div>
          <input type="text" id="drug_nmb" class="border p-2 rounded w-full">
        </div>

        <div class="mb-2">
          <div class="font-medium">Vaso-active agent (drug & dose):</div>
          <input type="text" id="drug_vasoactive" class="border p-2 rounded w-full">
        </div>

        <div class="mb-2">
          <div class="font-medium">Other drugs:</div>
          <input type="text" id="drug_other" class="border p-2 rounded w-full">
        </div>
      </div>

      <div>
        <div class="font-medium">Spinal precautions used (if applicable):</div>
        <input type="text" id="spinal_precautions" class="border p-2 rounded w-full">
      </div>

      <div>
        <div class="font-medium">Comments:</div>
        <textarea id="comments" class="border p-2 rounded w-full" rows="3"></textarea>
      </div>

      <div>
        <div class="font-medium">Adverse events:</div>
        <textarea id="adverse_events" class="border p-2 rounded w-full" rows="3"></textarea>
      </div>

    </div>

    <!-- GENERATE BUTTON -->
    <button onclick="generateNote()"
            class="mt-8 bg-blue-600 text-white px-4 py-2 rounded">
      Generate Text Note
    </button>

    <!-- OUTPUT -->
    <div class="mt-6">
      <textarea id="output" class="w-full h-80 border p-3 rounded font-mono"
                readonly></textarea>

      <div class="flex flex-col md:flex-row md:items-center md:gap-4 mt-3">
        <button onclick="copyText()" class="bg-green-600 text-white px-4 py-2 rounded w-full md:w-auto">
          Copy to Clipboard
        </button>

         <p class="text-gray-700 text-sm mt-2 md:mt-0">
      Paste these notes into the patient PPM record, set title as <strong>"Intubation"</strong>.
    </p>
        
      </div>
    </div>

  </div>

<script>

// enforce Yes/No exclusivity
function onlyOne(checkbox) {
  const group = document.getElementsByName(checkbox.name);
  group.forEach(box => {
    if (box !== checkbox) box.checked = false;
  });
}

// get selected checkbox value
function getValue(name) {
  const boxes = document.getElementsByName(name);
  for (let b of boxes) if (b.checked) return b.value;
  return "Not selected";
}

// multi-select helper
function getMultiValues(name, otherFieldId = null) {
  const boxes = document.getElementsByName(name);
  let values = [];

  boxes.forEach(b => {
    if (b.checked && b.value !== "Other") values.push(b.value);
    if (b.checked && b.value === "Other" && otherFieldId) {
      const otherText = document.getElementById(otherFieldId).value.trim();
      if (otherText) values.push(otherText);
    }
  });

  if (values.length === 0) return "Not selected";
  return values.join(", ");
}

function generateNote() {
  let output = "INTUBATION PROCEDURE NOTE\n\n";

  // Date handling
  let rawDate = document.getElementById('proc_date').value;
  let ukDate = "Not selected";
  if (rawDate) {
    const parts = rawDate.split('-');
    ukDate = `${parts[2]}/${parts[1]}/${parts[0]}`;
  }

  output += "=== PROCEDURE DETAILS ===\n";
  output += `Procedure Date: ${ukDate}\n`;
  output += `Time: ${document.getElementById("proc_time").value}\n`;
  output += `Operator: ${document.getElementById("operator").value}\n`;
  output += `Assistant: ${document.getElementById("assistant").value}\n`;
  output += `Supervisor: ${document.getElementById("supervisor").value}\n\n`;

 // INTUBATION DETAILS
  output += "=== INTUBATION DETAILS ===\n";
  output += `Indication: ${document.getElementById("indication_intub").value}\n\n`;

  output += "=== PERSONNEL ===\n";
  output += `Airway: ${document.getElementById("airway_name").value} (Grade: ${document.getElementById("airway_grade").value})\n`;
  output += `Drugs: ${document.getElementById("drugs_name").value} (Grade: ${document.getElementById("drugs_grade").value})\n`;
  output += `Other assistant: ${document.getElementById("assistant_name").value} (Grade: ${document.getElementById("assistant_grade").value})\n\n`;

  // Intubation technical details
  output += "=== TECHNIQUE ===\n";
  output += `Pre-oxygenation: ${getMultiValues("preox", "preox_other")}\n`;
  output += `Laryngoscopy grade: ${document.getElementById("laryngoscopy_grade").value}\n`;
  output += `Laryngoscope used: ${getMultiValues("laryngoscope", "laryngoscope_other")}\n`;
  output += `Adjuncts used: ${document.getElementById("adjuncts_used").value}\n`;
  output += `ETT size: ${document.getElementById("ett_size").value}\n`;
  output += `Length at teeth: ${document.getElementById("ett_length").value} cm\n`;
  output += `Route: ${getValue("route")}\n\n`;

  output += "=== DRUGS USED ===\n";
  output += `Opiate: ${document.getElementById("drug_opiate").value}\n`;
  output += `Induction: ${document.getElementById("drug_induction").value}\n`;
  output += `Muscle relaxant: ${document.getElementById("drug_nmb").value}\n`;
  output += `Vaso-active agent: ${document.getElementById("drug_vasoactive").value}\n`;
  output += `Other drugs: ${document.getElementById("drug_other").value}\n\n`;

  output += `Spinal precautions used: ${document.getElementById("spinal_precautions").value}\n`;
  output += `Comments: ${document.getElementById("comments").value}\n`;
  output += `Adverse events: ${document.getElementById("adverse_events").value}\n`;

  


output += "\n----------------------------------------\n\n";

  output += "=== SAFETY CHECKLIST ===\n";
  // BEFORE THE PROCEDURE
  output += "=== BEFORE THE PROCEDURE ===\n";
  output += `• Patient identity checked: ${getValue("identity")}\n`;
  output += `• Patient position optimised: ${getValue("positionOptimised")}\n`;
  output += `• Spinal precautions required: ${getValue("spinalPrecautions")}\n`;
  output += `• Pre-oxygenation plan: ${getValue("preoxygenation")}\n`;
  output += `• Cricoid pressure: ${getValue("cricoid")}\n`;
  output += `• NG tube required: ${getValue("ngRequired")}\n`;
  output += `• NG tube aspirated: ${getValue("ngAspirated")}\n`;
  output += `• Drug allergies: ${getValue("drugAllergies")}\n`;
  output += `• Adequate venous access: ${getValue("venousAccess")}\n`;
  output += `• Monitoring attached: ${getValue("monitoring")}\n`;
  output += `• Manual ventilation device: ${getValue("ventDevice")}\n`;
  output += `• Suction available: ${getValue("suction")}\n`;
  output += `• Laryngoscopes available: ${getValue("laryngoscopes")}\n`;
  output += `• Endotracheal tubes: ${getValue("ett")}\n`;
  output += `• Bougie available: ${getValue("bougie")}\n`;
  output += `• Oropharyngeal airways: ${getValue("opa")}\n`;
  output += `• Supraglottic airway: ${getValue("sga")}\n`;
  output += `• Difficult Airway Trolley: ${getValue("dat")}\n`;
  output += `• Drugs ready: ${getValue("drugsReady")}\n`;
  output += `• Senior help known: ${getValue("seniorHelp")}\n`;
  output += `• Tasks allocated: ${getValue("tasksAllocated")}\n\n`;

  // TIME OUT
  output += "=== TIME OUT ===\n";
  output += `• Verbal confirmation: ${getValue("teamConfirm")}\n`;
  output += `• Difficult airway anticipated: ${getValue("difficultAirway")}\n`;
  output += `• Difficult airway plans discussed: ${getValue("airwayPlans")}\n`;
  output += `• Other concerns: ${getValue("otherConcerns")}\n`;
  output += `• Concern plans discussed: ${getValue("concernPlans")}\n\n`;

  // SIGN OUT
  output += "=== SIGN OUT ===\n";
  output += `• CO₂ confirmation: ${getValue("co2Confirm")}\n`;
  output += `• Bilateral air entry: ${getValue("airEntry")}\n`;
  output += `• ETT secured: ${getValue("ettSecured")}\n`;
  output += `• Cuff pressure checked: ${getValue("cuffPressure")}\n`;
  output += `• Ventilator settings appropriate: ${getValue("ventSettings")}\n`;
  output += `• Analgesia/sedation started: ${getValue("analgSed")}\n`;
  output += `• Chest X-ray required: ${getValue("cxrRequired")}\n`;
  output += `• Documentation: ${getValue("documentation")}\n\n`;

  document.getElementById("output").value = output;
  }
function copyText() {
  navigator.clipboard.writeText(document.getElementById("output").value);
}

window.addEventListener('DOMContentLoaded', () => {
  document.getElementById('proc_date').value = new Date().toISOString().split('T')[0];
});

</script>

</body>
</html>
