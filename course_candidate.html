rows.forEach(row => {
  if (!row.trim()) return; // skip empty lines
  const [session, releaseDateStr, candidateLink] = row.split(',');
  const releaseDate = new Date(releaseDateStr.trim());
  const now = new Date();

  const div = document.createElement('div');
  div.className = 'p-4 bg-white rounded shadow';

  const h3 = document.createElement('h3');
  h3.textContent = session.trim();
  h3.className = 'text-xl font-semibold mb-2';
  div.appendChild(h3);

  const p = document.createElement('p');
  if (now >= releaseDate) {
    const a = document.createElement('a');
    a.href = candidateLink.trim(); // <--- Dropbox link from sheet
    a.textContent = "Access Session";
    a.target = "_blank"; // open in new tab
    a.className = "text-blue-500 hover:underline";
    p.appendChild(a);
  } else {
    p.textContent = `Available on ${releaseDate.toDateString()}`;
    p.className = 'text-gray-500 italic';
  }
  div.appendChild(p);

  container.appendChild(div);
});
